<!DOCTYPE html>
<html>
<head>
    <title>TSS Converter - Pipeline Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 50px auto; 
            padding: 20px; 
            background: #f8f9fa;
        }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header { 
            text-align: center; 
            color: #FF6B6B; 
            margin-bottom: 30px;
        }
        .upload-area {
            border: 2px dashed #FF6B6B;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            background: #fff5f5;
        }
        .btn {
            background: #FF6B6B;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .btn:hover { background: #ff5252; }
        .progress {
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-bar {
            background: #FF6B6B;
            height: 30px;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .step {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #6c757d;
            background: #f8f9fa;
        }
        .step.completed { border-left-color: #28a745; background: #d4edda; }
        .step.running { border-left-color: #ffc107; background: #fff3cd; }
        .step.error { border-left-color: #dc3545; background: #f8d7da; }
        .download-section {
            background: #e7f5e7;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-top: 20px;
        }
        .hidden { display: none; }
        .info { 
            background: #d1ecf1; 
            border-left: 4px solid #17a2b8; 
            padding: 15px; 
            margin: 15px 0; 
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä TSS Converter</h1>
            <p>Excel Template Converter - Simple Pipeline Test</p>
        </div>

        <div id="uploadSection">
            <div class="upload-area">
                <h3>üìÅ Upload Excel File</h3>
                <p>Select Excel (.xlsx) file to convert</p>
                <input type="file" id="fileInput" accept=".xlsx" style="margin: 10px 0;">
                <br>
                <button class="btn" onclick="startProcessing()">üöÄ Start Conversion</button>
            </div>
        </div>

        <div id="progressSection" class="hidden">
            <h3>üîÑ Processing Progress</h3>
            <div class="progress">
                <div id="progressBar" class="progress-bar" style="width: 0%">0%</div>
            </div>
            
            <div id="step1" class="step">‚è∏Ô∏è Step 1: Create Template</div>
            <div id="step2" class="step">‚è∏Ô∏è Step 2: Extract Data</div>
            <div id="step3" class="step">‚è∏Ô∏è Step 3: Map Data</div>
            <div id="step4" class="step">‚è∏Ô∏è Step 4: Fill Data</div>
            <div id="step5" class="step">‚è∏Ô∏è Step 5: Filter & Deduplicate</div>
        </div>

        <div id="downloadSection" class="download-section hidden">
            <h3>üéâ Processing Complete!</h3>
            <p>File has been successfully converted.</p>
            <button class="btn" onclick="downloadFile()">üì• Download Converted File</button>
            <button class="btn" onclick="resetProcess()">üîÑ Process New File</button>
        </div>

        <div class="info">
            <strong>Instructions:</strong>
            <ul>
                <li>Select an Excel file (.xlsx format)</li>
                <li>File must contain "Product name" and "Article number" columns</li>
                <li>Maximum file size: 50MB</li>
                <li>Processing may take a few minutes for large files</li>
            </ul>
        </div>
    </div>

    <script>
        let currentStep = 0;
        let processing = false;

        function startProcessing() {
            const fileInput = document.getElementById('fileInput');
            if (!fileInput.files[0]) {
                alert('Please select a file first!');
                return;
            }

            if (processing) return;
            processing = true;

            // Hide upload section, show progress
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('progressSection').classList.remove('hidden');

            // Start simulation (replace with actual API calls)
            simulateProcessing();
        }

        function simulateProcessing() {
            const steps = [
                { id: 'step1', name: 'Step 1: Create Template', duration: 2000 },
                { id: 'step2', name: 'Step 2: Extract Data', duration: 3000 },
                { id: 'step3', name: 'Step 3: Map Data', duration: 4000 },
                { id: 'step4', name: 'Step 4: Fill Data', duration: 2000 },
                { id: 'step5', name: 'Step 5: Filter & Deduplicate', duration: 3000 }
            ];

            processStep(0, steps);
        }

        function processStep(stepIndex, steps) {
            if (stepIndex >= steps.length) {
                // Processing complete
                document.getElementById('progressSection').classList.add('hidden');
                document.getElementById('downloadSection').classList.remove('hidden');
                processing = false;
                return;
            }

            const step = steps[stepIndex];
            const stepElement = document.getElementById(step.id);
            
            // Mark as running
            stepElement.className = 'step running';
            stepElement.innerHTML = '‚è≥ ' + step.name + ' (Running...)';

            // Update progress bar
            const progress = ((stepIndex + 1) / steps.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressBar').textContent = Math.round(progress) + '%';

            // Simulate processing time
            setTimeout(() => {
                // Mark as completed
                stepElement.className = 'step completed';
                stepElement.innerHTML = '‚úÖ ' + step.name + ' (Completed)';
                
                // Process next step
                processStep(stepIndex + 1, steps);
            }, step.duration);
        }

        function downloadFile() {
            // Simulate file download
            alert('File download started! (This is a simulation)');
        }

        function resetProcess() {
            // Reset all states
            processing = false;
            currentStep = 0;
            
            // Reset UI
            document.getElementById('uploadSection').classList.remove('hidden');
            document.getElementById('progressSection').classList.add('hidden');
            document.getElementById('downloadSection').classList.add('hidden');
            
            // Reset progress bar
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('progressBar').textContent = '0%';
            
            // Reset steps
            const steps = ['step1', 'step2', 'step3', 'step4', 'step5'];
            steps.forEach((stepId, index) => {
                const element = document.getElementById(stepId);
                element.className = 'step';
                element.innerHTML = `‚è∏Ô∏è Step ${index + 1}: ${element.textContent.split(':')[1].split('(')[0].trim()}`;
            });
            
            // Clear file input
            document.getElementById('fileInput').value = '';
        }

        // Add drag and drop functionality
        const uploadArea = document.querySelector('.upload-area');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.background = '#ffe6e6';
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.background = '#fff5f5';
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.background = '#fff5f5';
            
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].name.endsWith('.xlsx')) {
                document.getElementById('fileInput').files = files;
            } else {
                alert('Please drop an Excel (.xlsx) file');
            }
        });
    </script>
</body>
</html>